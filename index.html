<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Marriage Proposal Form</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>

  <h1>üíç Make a Proposal üíç</h1>
  <!-- Removed method="post" -->
  <form id="proposalForm">
    
    <div class="row">
      <div>
        <label for="wname">Wife's Name:</label>
        <input type="text" id="wname" name="wname" placeholder="Enter wife's name" required>
      </div>
      <div>
        <label for="wemail">Wife's Email:</label>
        <input type="email" id="wemail" name="wemail" placeholder="Enter wife's email" required>
      </div>
    </div>

    <div class="row">
      <div>
        <label for="hname">Husband's Name:</label>
        <input type="text" id="hname" name="hname" placeholder="Enter husband's name" required>
      </div>
      <div>
        <label for="hemail">Husband's Email:</label>
        <input type="email" id="hemail" name="hemail" placeholder="Enter husband's email" required>
      </div>
    </div>

    <div class="row full-width">
      <div>
        <label for="dob">Date of Certificate:</label>
        <input type="date" id="dob" name="dob" max="">
        <div class="result" id="result"></div>
      </div>
    </div>

    <center>
        <button type="submit">Next ></button>
    </center> 

  </form>

  <script src="https://cdn.jsdelivr.net/npm/emailjs-com@3/dist/email.min.js"></script>
  <script>
     // Initialize EmailJS
    (function(){
      emailjs.init("uUP20PajbSsucUyeQ");
    })();

    // Set today's date as max
    const today = new Date().toISOString().split("T")[0];
    document.getElementById("dob").setAttribute("max", today);

    document.getElementById("dob").addEventListener("change", function() {
      document.getElementById("result").innerText =
        "üìÖ You selected: " + this.value;
    });

    // Handle form submit
    document.getElementById("proposalForm").addEventListener("submit", function(e) {
      e.preventDefault(); // ‚úÖ stop default POST request (fixes 405)

      const formData = {
        wname: document.getElementById("wname").value,
        wemail: document.getElementById("wemail").value,
        hname: document.getElementById("hname").value,
        hemail: document.getElementById("hemail").value,
        dob: document.getElementById("dob").value
      };

      emailjs.send("service_brl5mbu", "template_4gw5kam", formData)
        .then(() => {
          alert("‚úÖ Proposal sent successfully!");
          window.location.href = "page1.html"; // redirect after success
        }, (err) => {
          console.error("‚ùå Failed to send: ", err);
          alert("Error sending proposal. Check console.");
        });
    });
  </script>

</body>
</html>
